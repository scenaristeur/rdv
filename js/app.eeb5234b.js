(function(){"use strict";var e={609:function(e,t,o){var i=o(9242),s=o(3396);function r(e,t){const o=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(o)}var l=o(89);const n={},a=(0,l.Z)(n,[["render",r]]);var d=a,u=o(5431);(0,u.z)("/rdv/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh."),alert("This app has been updated, please close the app & re-open")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var c=o(2483);const p={class:"home"};function m(e,t,o,i,r,l){const n=(0,s.up)("WorldMap"),a=(0,s.up)("MenuComponent"),d=(0,s.up)("ProfileView"),u=(0,s.up)("WikipediaView"),c=(0,s.up)("UsersView"),m=(0,s.up)("RdvView"),f=(0,s.up)("PostView"),h=(0,s.up)("GraphView"),v=(0,s.up)("RdvUpdater"),g=(0,s.up)("UsersUpdater");return(0,s.wg)(),(0,s.iD)("div",p,[(0,s.Wm)(n),(0,s.Wm)(a),(0,s.Wm)(d),"wikipedia"==l.view?((0,s.wg)(),(0,s.j4)(u,{key:0})):(0,s.kq)("",!0),"users"==l.view?((0,s.wg)(),(0,s.j4)(c,{key:1})):(0,s.kq)("",!0),"rdv"==l.view?((0,s.wg)(),(0,s.j4)(m,{key:2})):(0,s.kq)("",!0),"post"==l.view?((0,s.wg)(),(0,s.j4)(f,{key:3})):(0,s.kq)("",!0),"graph"==l.view?((0,s.wg)(),(0,s.j4)(h,{key:4})):(0,s.kq)("",!0),(0,s.Wm)(v),(0,s.Wm)(g)])}var f=o(7139),h=o(4870),v=o(65),g=o.p+"img/marker.f58b9982.png",w=o.p+"img/marker_selected.9c72dae0.png",k=o.p+"img/here.b7fe6ce7.png",A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAADFUlEQVR4Xu2a/bVNMRDF96vAUwE6eCqgA1SADp4KUAEdoAJU8KiADngVoALWb62bta6Y5EySm+uedSZ/3puPmZ2dyew5OdPG29nG/VcAEAzYOAJxBDZOgAiCLUfgtqTnkh5KOm9gTssa1rS/G9b6KemDpJeSvnvGeY27L+l9o+Npfe8aJXtbAEhzAMQjSZ+WQPAYx85/6XSe9T1r1OzsAYD5AOHuEhM8xr2V9HgJycr/njVmAMCc7yQ9qU3uMe7HwO7/TwYkFtwcBcCi4GfP+dot/GKAPQz1jueoWkytbrKHARYARFmvYYP+u4cTqK+M3gHAjCMQDIgjEDEggmDcAu4L6t+ODyRdZD9/lfRxYM6TvwZRkK8WUtOk5p7tcvkWPE4aAPJxnPfKaIAABHSIt00DwGtAqR+xgjpCT5ueb3hS4R7D0xh2/s3IBJKeNjKhabmZAED3bxXaX+9pdYTMrYLlHIc7HTHBBcRMAEp1hF+7QEjpar9RamPMDcPyRV3v8rZVKfVOuhtnqUicZ7fZVavBGmp5OQj0r+r6XltnMYDdpIaYN+p0+c7nfUbGNuMwCwAr8nPm2X1PgwV5TJhyIxwTAKpI3NWeRjX3XtYxAJghwY/JAGjNdeZpXJ/5cVkVA0YC2chYD7h/9ZnFABaxrsGlpKaUPHF9enVEEwgzASglQoBAemslQqTNlqOrTIRKSU3aIWJC+oDJeS9dkUvJU9OO551nMoC1Ni2GEtirl8OH+DIEE14XhI5FYWh/2SiDpxVEDgEAThITAIFrzlJ89MFxgiPOlwRT6cyfPAD7hgOCVRRdEkq1gLcqAIYid2FwABBfh+PzeLwPiAcSRoCMFyK1K8ejBaxECKXn/WxFKWyk5aWx0lzkFSRaTXrHAwAZWSlz8zjmWaM2T+9DyZRZVusIHuM2/1ASnc63+14WeECewQB0Bcei+mjaaxxpJnl6DwjeNUog9BwBnEdvHOSxdDIMJqDta2rOcuKYACQ1iZ0HfS7vCXar7DO6O6t0et/oAGD1WzjoQDBgEMDVDw8GrH4LBx34A8fSukGbT39pAAAAAElFTkSuQmCC",b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAADUElEQVR4Xu2a/ZFNQRDFz0aACBABIkAEiAARIAJEgAjYCBABIkAEiAARUD91p+rtrX13pme6+131bv+zW/VmpnvO9MeZvnOiI5eTI9+/NgA2DzhyBA4RAtclXZN0ZYb9d0lfJX3JPJMsAG5Jui/prqSLlQ0CxEdJp9PfUDyiAeCUX0sCgB4BiIeSACVEIgF4JOmlk9WPJb1yWuvMMlEAcOoPnA1+M3mD67IRALydYt3V0Gmxd5LueS7sDQAuj+tHCqFASLiIJwBkeE4/Q/ACvGFYPAH4dk5tHzZwzwJUhasei3sBQMIj8WUK5ZHEOCReAGSeftmwixd4AAC1/Ww8hvcTR4DoIOQPvOiOcZ0bo9TZAwAy8guD4Uuuaw2lJ6NkywMATvFmIwDPJT2rjOX3p43rfRqg2f9UZANwSdKvyua4LP38nwD4E2Bsq1cBJqB2i4cHtAJA4iPZtUgrAMNenAkAjQ6ydotQVaguLTK0h6HJk3WW04K91e729BDgFS2yiiQIG6Pb0yKAdbsy0HKbpGs0dO328AArD+ASAxeYVwOyP3zCsqFV8IAeJsjmAaKEA27f0i+cO88qmCBGsZHLLTHgOOaHx+3TIwTYU0YjZI6dS2PECwBL5vZygpaKUtXlBQCKiGnrba5q4J4BFlK1qMMTAHr/H3p3ZJxHKS1XaePUs8M9AWBlCynqNXyY/Owq9gYgwwvcTh8gvAGI9gLX048CILIiuGT+yBAoa0fwApe6P088ESGADng97PBCb6abzYP1Qblr3SSzuigAMMTzS5Hbl6AsDyh6PMiRG+k5zz0iPcAjFH5PFx531y9gRAMwGgphrp8JALp6qkJI1s/OAbv6aIryOqxFeC3W2hRtWW/vmIwQKMohSIBQK43EPZuvNU+HNp4dAkVfS2kMj/sMJrh0Okvf/lq+Hbqc/KE8YIkfhNb7fahl5oBdG6DK9A5KUiTpcZUOq/drA2CXJPE/CTJ98yg+lAeUAymlLvWB9KGToGsSG13s0B4wav/w/F4ASFitz2KGjWxcgJ6B+dlcLwCWdzyN9g8P6+oXbgB04r55gOEpWyfG5mmpIcAjBstDBvNuOibAJczP6HtzQId965yyAbDOc8mzavOAPKzXqekvWhOGQSnRji0AAAAASUVORK5CYII=",y=o.p+"img/location-pin.889383ad.png";const _={key:0},P={key:1},D={for:"datePicker"},W=(0,s._)("code",null,"When ?",-1),U={key:0},C=(0,s._)("i",null,"7 days max",-1),V=[C],S={role:"group"},I=(0,s._)("label",{for:"input-live"},[(0,s._)("code",null,"Title:")],-1),j=(0,s._)("label",{for:"textarea"},[(0,s._)("code",null,"Description:")],-1),O=(0,s._)("label",{for:"color"},[(0,s._)("code",null,"Color:")],-1);function x(e,t,o,i,r,l){const n=(0,s.up)("VueDatePicker"),a=(0,s.up)("b-form-input"),d=(0,s.up)("b-form-invalid-feedback"),u=(0,s.up)("b-form-text"),c=(0,s.up)("b-form-textarea"),p=(0,s.up)("b-col"),m=(0,s.up)("b-row"),f=(0,s.up)("BModal");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(f,{modelValue:r.showRdvForm,"onUpdate:modelValue":t[5]||(t[5]=e=>r.showRdvForm=e),onOk:l.onAddRdv,size:"lg"},{default:(0,s.w5)((()=>[0==r.edit?((0,s.wg)(),(0,s.iD)("div",_,"Rdv non modifiable")):(0,s.kq)("",!0),null!=l.rdv?((0,s.wg)(),(0,s.iD)("div",P,[(0,s._)("label",D,[W,(0,s.Uk)(),1==r.edit?((0,s.wg)(),(0,s.iD)("small",U,V)):(0,s.kq)("",!0)]),(0,s.Wm)(n,{id:"datePicker",modelValue:r.date,"onUpdate:modelValue":t[0]||(t[0]=e=>r.date=e),range:"","partial-range":"","max-range":"7","format-locale":r.fr,format:"Pp","min-date":new Date,"max-date":new Date((new Date).setDate((new Date).getDate()+15)),disabled:!r.edit},null,8,["modelValue","format-locale","min-date","max-date","disabled"]),(0,s._)("div",S,[I,(0,s.Wm)(a,{id:"input-live",modelValue:l.rdv.title,"onUpdate:modelValue":t[1]||(t[1]=e=>l.rdv.title=e),state:r.stateTitle,onInput:l.titleState,disabled:!r.edit,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Title",trim:""},null,8,["modelValue","state","onInput","disabled"]),(0,s.Wm)(d,{id:"input-live-feedback"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Enter at least 3 and less than 50 letters ")])),_:1}),(0,s.Wm)(u,{id:"input-live-help"},{default:(0,s.w5)((()=>[(0,s.Uk)("A cool title for your event.")])),_:1})]),j,(0,s.Wm)(c,{id:"textarea",modelValue:l.rdv.description,"onUpdate:modelValue":t[2]||(t[2]=e=>l.rdv.description=e),placeholder:"Description",rows:"3","max-rows":"6",disabled:!r.edit},null,8,["modelValue","disabled"]),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[O,(0,s.Wm)(a,{id:"color",modelValue:l.rdv.color,"onUpdate:modelValue":t[3]||(t[3]=e=>l.rdv.color=e),disabled:!r.edit,type:"color"},null,8,["modelValue","disabled"]),(0,s.Wm)(a,{id:"input-live",modelValue:l.rdv.tags,"onUpdate:modelValue":t[4]||(t[4]=e=>l.rdv.tags=e),disabled:!r.edit,"aria-describedby":"input-live-help input-live-feedback",placeholder:"tags comma separated",trim:""},null,8,["modelValue","disabled"])])),_:1})])),_:1})])):(0,s.kq)("",!0)])),_:1},8,["modelValue","onOk"])])}var E=o(6208),z=o(8014),M={name:"RdvForm",components:{VueDatePicker:E.Z},data(){return{showRdvForm:!1,fr:z.Z,edit:!0,date:null,stateTitle:!1}},methods:{onAddRdv(){console.log(this.date),null==this.date[1]&&(this.date[1]=this.date[0]),this.rdv.start=this.date[0].toString(),this.rdv.end=this.date[1].toString(),this.rdv.updated=Date.now(),console.log(this.rdv),this.$store.dispatch("core/updateYstoreRdvs",this.rdv)},titleState(){this.stateTitle=1!=this.edit||this.rdv.title.length>2&&this.rdv.title.length<51}},watch:{rdv(){this.showRdvForm=null!=this.rdv,void 0!=this.rdv.start?(this.date=[this.rdv.start,this.rdv.end],console.log(this.date),this.edit=!1):this.edit=!0}},computed:{rdv(){return this.$store.state.core.rdv}}};const T=(0,l.Z)(M,[["render",x]]);var B=T,H={__name:"WorldMap",setup(e){const t=(0,s.f3)("ol-feature"),o=(0,s.f3)("ol-geom"),i=(0,h.iH)([2.58,45]),r=(0,h.iH)("EPSG:4326"),l=(0,h.iH)(15),n=(0,h.iH)(0),a=(0,h.iH)("white"),d=(0,h.iH)(1),u=(0,h.iH)(10),c=(0,v.oR)(),p=(0,h.iH)(),m=(0,h.iH)([]),_=(0,h.iH)(!1),P=(0,h.iH)([]),D=(0,h.iH)([]);try{const e=localStorage.getItem("rdv_map_view");let t=JSON.parse(e);l.value=t.zoom,i.value=t.center}catch(z){console.log(z)}const W=(0,h.iH)([]),U=(0,s.Fl)((()=>c.state.core.rdvs)),C=(0,s.Fl)((()=>c.state.core.places)),V=(0,s.Fl)((()=>c.state.core.users));(0,s.YP)(U,(e=>{console.log("prop rdvs changed",e);for(let i of Object.values(e)){console.log("-----",i.uuid,i.title,i);const e=new t({geometry:new o.Point(i.coordinates),name:i.title,uuid:i.uuid,data:i});P.value.source.addFeature(e)}})),(0,s.YP)(C,(e=>{console.log("prop places changed",e),D.value.source.clear();for(let i of Object.values(e)){console.log("-----",i);const e=new t({geometry:new o.Point([i.lon,i.lat]),name:i.title});D.value.source.addFeature(e)}}));const S=e=>{m.value=e.target.getPosition(),c.commit("core/updateMyPosition",m.value),1==_.value&&p.value?.setCenter(e.target?.getPosition()),localStorage.setItem("rdv_map_view",JSON.stringify({center:p.value.getCenter(),zoom:p.value.getZoom()}))},I=(0,s.Fl)((()=>c.state.core.centerPoint));(0,s.YP)(I,(e=>{p.value?.setCenter(e)}));const j=(0,s.f3)("ol-selectconditions"),O=j.click,x=e=>{if(e.selected.length>0){let t=e.selected[0],o=t.get("uuid"),i=t.get("title");console.log("selected",t,o,i);let s=t.get("name"),r=t.get("data");console.log(s,r,r.description,r.color),c.commit("core/setRdv",r)}},E=(e,t)=>{let o=e.get("color");void 0!=t.getImage().getFill&&t.getImage().getFill().setColor(o);let i=e.get("name");t.getText().setText(i)};return W.value=[{text:"Centrer la carte ici",icon:A,classname:"some-style-class",callback:e=>{p.value.setCenter(e.coordinate)}},{text:"Ajouter un rdv",classname:"some-style-class",icon:b,callback:e=>{console.log(e),c.commit("core/setRdv",{coordinates:e.coordinate})}},"-"],(e,t)=>{const o=(0,s.up)("BButton"),c=(0,s.up)("b-button-group"),v=(0,s.up)("ol-view"),A=(0,s.up)("ol-source-osm"),b=(0,s.up)("ol-tile-layer"),U=(0,s.up)("ol-style-fill"),C=(0,s.up)("ol-style-icon"),I=(0,s.up)("ol-style-text"),j=(0,s.up)("ol-style"),z=(0,s.up)("ol-interaction-select"),M=(0,s.up)("ol-context-menu-control"),T=(0,s.up)("ol-geom-point"),H=(0,s.up)("ol-feature"),R=(0,s.up)("ol-source-vector"),F=(0,s.up)("ol-vector-layer"),K=(0,s.up)("ol-geolocation"),Z=(0,s.up)("ol-geom-multi-point"),q=(0,s.up)("ol-style-stroke"),G=(0,s.up)("ol-style-circle"),$=(0,s.up)("ol-map");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(c,{size:"sm",class:"map-toolbar"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{onClick:t[0]||(t[0]=e=>_.value=!_.value),variant:1==_.value?"warning":"success"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,f.zw)(1==_.value?"don't follow me":"follow me"),1)])),_:1},8,["variant"])])),_:1}),(0,s.Wm)($,{loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,style:{height:"400px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{ref_key:"view",ref:p,center:i.value,rotation:n.value,zoom:l.value,projection:r.value},null,8,["center","rotation","zoom","projection"]),(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(A)])),_:1}),(0,s.Wm)(z,{onSelect:x,condition:(0,h.SU)(O),features:e.selectedFeatures},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{overrideStyleFunction:E},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{color:a.value},null,8,["color"]),(0,s.Wm)(C,{src:(0,h.SU)(w),scale:.1},null,8,["src"]),(0,s.Wm)(I,{color:"white",text:"Hellooooo"})])),_:1})])),_:1},8,["condition","features"]),(0,s.Wm)(M,{items:W.value},null,8,["items"]),(0,s.Wm)(K,{projection:r.value,"onChange:position":S},{default:(0,s.w5)((()=>[(0,s._)("template",null,[(0,s.Wm)(F,{zIndex:2},{default:(0,s.w5)((()=>[(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s.Wm)(H,{ref:"positionFeature"},{default:(0,s.w5)((()=>[(0,s.Wm)(T,{coordinates:m.value},null,8,["coordinates"]),(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)(C,{src:(0,h.SU)(k),scale:.1},null,8,["src"])])),_:1})])),_:1},512)])),_:1})])),_:1})])])),_:1},8,["projection"]),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(V.value,((e,t)=>((0,s.wg)(),(0,s.j4)(H,{key:t},{default:(0,s.w5)((()=>[void 0!=e.position?((0,s.wg)(),(0,s.j4)(Z,{key:0,coordinates:e.position.coordinates},null,8,["coordinates"])):(0,s.kq)("",!0),(0,s.Wm)(j,null,{default:(0,s.w5)((()=>[(0,s.Wm)(G,{radius:u.value},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{color:a.value},null,8,["color"]),(0,s.Wm)(q,{color:e.profile.color,width:d.value},null,8,["color","width"]),(0,s.Wm)(I,{text:e.profile.name},null,8,["text"])])),_:2},1032,["radius"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s.Wm)(R,{ref_key:"rdvMarkers",ref:P},null,512),(0,s.Wm)(j,{overrideStyleFunction:E},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{color:a.value},null,8,["color"]),(0,s.Wm)(C,{src:(0,h.SU)(g),scale:.05},null,8,["src"]),(0,s.Wm)(I,{text:"Hellooooo"})])),_:1})])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s.Wm)(R,{ref_key:"placeMarkers",ref:D},null,512),(0,s.Wm)(j,{overrideStyleFunction:E},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{color:a.value},null,8,["color"]),(0,s.Wm)(C,{src:(0,h.SU)(y),scale:.05},null,8,["src"]),(0,s.Wm)(I,{text:"Hellooooo"})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(B)],64)}}};const R=(0,l.Z)(H,[["__scopeId","data-v-77727f80"]]);var F=R;const K={class:"row"},Z=(0,s._)("label",{class:"col-form-label col-2",for:"inline-form-input-name"},"Nom",-1),q={class:"col-8"},G={class:"col-2"},$={class:"row"},L=(0,s._)("label",{class:"col-form-label col-2",for:"inline-form-input-profile"},"Profil",-1),Y={class:"col-8"},J={class:"col-2"},N={style:{"margin-bottom":"30px"}},Q=["onClick"],X={key:0,class:"row"},ee=(0,s._)("label",{class:"col-form-label col-2",for:"inline-form-input-profile"},"intérêt",-1),te={class:"col-8"},oe={class:"col-2"};function ie(e,t,o,r,l,n){const a=(0,s.up)("BFormInput"),d=(0,s.up)("BButton"),u=(0,s.up)("BListGroupItem"),c=(0,s.up)("BListGroup"),p=(0,s.up)("BForm"),m=(0,s.up)("BModal");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(m,{modelValue:n.showProfile,"onUpdate:modelValue":t[4]||(t[4]=e=>n.showProfile=e),onOk:n.updateUser},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s._)("div",K,[Z,(0,s._)("div",q,[(0,s.Wm)(a,{id:"inline-form-input-name",class:"mb-2 me-sm-2 mb-sm-0",modelValue:l.user.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.user.name=e),placeholder:"username"},null,8,["modelValue"])]),(0,s._)("div",G,[(0,s.Wm)(a,{modelValue:l.user.color,"onUpdate:modelValue":t[1]||(t[1]=e=>l.user.color=e),type:"color"},null,8,["modelValue"])])]),(0,s._)("div",$,[L,(0,s._)("div",Y,[(0,s.Wm)(a,{id:"inline-form-input-profile",modelValue:l.profile_name,"onUpdate:modelValue":t[2]||(t[2]=e=>l.profile_name=e),placeholder:"profile name",onKeyup:(0,i.D2)(n.addProfile,["enter"])},null,8,["modelValue","onKeyup"])]),(0,s._)("div",J,[(0,s.Wm)(d,{onClick:n.addProfile},{default:(0,s.w5)((()=>[(0,s.Uk)(" +")])),_:1},8,["onClick"])])]),(0,s.Uk)(" "+(0,f.zw)(n.profile)+" ",1),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.profiles,(e=>((0,s.wg)(),(0,s.j4)(u,{key:e.id,href:"#",active:n.profile==e.id,onClick:t=>n.changeProfile(e.id)},{default:(0,s.w5)((()=>[(0,s._)("h6",N,(0,f.zw)(e.name),1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.interests,(t=>((0,s.wg)(),(0,s.iD)("button",{key:t,type:"button",class:"btn btn-dark position-relative",style:{"margin-right":"'5px'"}},[(0,s.Uk)((0,f.zw)(t)+" ",1),(0,s._)("span",{class:"position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle",onClick:o=>n.remove_interest({profil:e.id,interest:t})}," X ",8,Q)])))),128)),e.interests.length<5?((0,s.wg)(),(0,s.iD)("div",X,[ee,(0,s._)("div",te,[(0,s.Wm)(a,{modelValue:l.new_interest,"onUpdate:modelValue":t[3]||(t[3]=e=>l.new_interest=e),value:l.new_interest,placeholder:"nouvel interêt",onKeyup:(0,i.D2)((t=>n.addInteret({profil:e.id})),["enter"])},null,8,["modelValue","value","onKeyup"])]),(0,s._)("div",oe,[(0,s.Wm)(d,{onClick:t=>n.addInteret({profil:e.id})},{default:(0,s.w5)((()=>[(0,s.Uk)(" +")])),_:2},1032,["onClick"])])])):(0,s.kq)("",!0)])),_:2},1032,["active","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue","onOk"])])}o(7658);var se=o(5288),re=o(9373),le=o(2213),ne=o(114);const ae={rdvs:{},posts:{}},de=(0,se.wI)(ae),ue=(0,se.ms)(de),ce=new ne.GL(ue),pe=new re.x$("rdv",ue,{awareness:ce,signaling:["wss://noosld-webrtc.glitch.me"]}),me=new le.VU("wss://yjs-leveldb.glitch.me/rdv","rdv",ue,{awareness:ce});pe.on("status",(e=>{console.log("** webrtcProvider in y_store",e.status)})),me.on("status",(e=>{console.log("## websocketProvider in y_store",e.status)}));var fe={name:"ProfileView",data(){return{user:{name:"user_"+Date.now(),color:"#ffb61e",clientID:ce.clientID},profile_name:"",interests:"",new_interest:""}},created(){let e=JSON.parse(localStorage.getItem("rdv_user"));if(console.log("localstorage user",e),e&&e.name&&e.color){this.user=e;let t=JSON.parse(localStorage.getItem("rdv_user_interests"));void 0!=t&&(console.log("from localstorage",t.profiles,t.profile),this.$store.commit("core/setProfiles",t.profiles),this.$store.commit("core/setProfile",t.profile))}ce.setLocalStateField("profile",this.user),this.updateInterests()},methods:{addInteret(e){if(this.new_interest.trim().length>0){console.log(this.new_interest,e);let t=this.profiles.find((t=>t.id==e.profil));t.interests.push(this.new_interest),this.new_interest="",console.log(t)}else alert("Ajoutez un centre d'intérêts")},remove_interest(e){console.log("remove",e.interest);let t=this.profiles.find((t=>t.id==e.profil));t.interests=t.interests.filter((t=>t!=e.interest))},onInputEventHandler(e){console.log(e),console.log(this.interests)},addProfile(){if(this.profile_name.trim().length>0){let e={name:this.profile_name,interests:[]};this.$store.commit("core/addProfile",e),this.profile_name=""}else alert("ajoutez un nom de profil")},updateUser(){console.log("User",this.user),ce.setLocalStateField("profile",this.user),localStorage.setItem("rdv_user",JSON.stringify(this.user)),this.updateInterests(),this.$store.commit("core/setShowProfile",!1)},changeProfile(e){console.log(e),this.$store.commit("core/setProfile",e)},updateInterests(){console.log("update interests"),ce.setLocalStateField("interests",{like:this.profiles.find((e=>e.id==this.profile))}),localStorage.setItem("rdv_user_interests",JSON.stringify({profiles:this.profiles,profile:this.profile}))}},watch:{profiles(){this.updateInterests()},profile(){this.updateInterests()}},computed:{profiles(){return this.$store.state.core.profiles},profile(){return this.$store.state.core.profile},showProfile(){return this.$store.state.core.showProfile}}};const he=(0,l.Z)(fe,[["render",ie]]);var ve=he;const ge={class:"row"},we={class:"col"},ke={key:0,class:"col"},Ae={class:"col"},be={key:0};function ye(e,t,o,i,r,l){const n=(0,s.up)("BBadge"),a=(0,s.up)("BListGroupItem"),d=(0,s.up)("BListGroup");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(d,{class:"scroll_list"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.users,(e=>((0,s.wg)(),(0,s.j4)(a,{key:e.profile.clientID,href:"#",onClick:t=>l.userClicked(e)},{default:(0,s.w5)((()=>[(0,s._)("h2",null,(0,f.zw)(e.profile.name),1),(0,s._)("div",ge,[(0,s._)("div",we,[(0,s._)("div",{class:"user_color",style:(0,f.j5)("width:20px;height:20px;background-color:"+e.profile.color)},null,4)]),void 0!=e.distance?((0,s.wg)(),(0,s.iD)("div",ke,(0,f.zw)(e.distance>1?e.distance+" km":Math.floor(1e3*e.distance)+" m"),1)):(0,s.kq)("",!0),(0,s._)("div",Ae,[void 0!=e.interests&&void 0!=e.interests.like&&void 0!=e.interests.like.interests&&l.profiles.length>0?((0,s.wg)(),(0,s.iD)("div",be,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.interests.like.interests,(e=>((0,s.wg)(),(0,s.j4)(n,{key:e,variant:l.getInterestVariant(e)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,f.zw)(e),1)])),_:2},1032,["variant"])))),128))])):(0,s.kq)("",!0)])])])),_:2},1032,["onClick"])))),128))])])),_:1})])}var _e={name:"UsersView",methods:{userClicked(e){console.log(e),void 0!=e.position&&this.$store.commit("core/centerToPoint",e.position.coordinates)},getInterestVariant(e){let t=this.profiles.find((e=>e.id==this.profile));return void 0!=t&&t.interests.includes(e)?"info":"light"}},computed:{profiles(){return this.$store.state.core.profiles},profile(){return this.$store.state.core.profile},users(){return this.$store.state.core.users}}};const Pe=(0,l.Z)(_e,[["render",ye],["__scopeId","data-v-67f5aeaa"]]);var De=Pe;const We=e=>((0,s.dD)("data-v-9f17f8e6"),e=e(),(0,s.Cn)(),e),Ue=We((()=>(0,s._)("p",null,"Clic droit sur la carte pour ajouter un rendez-vous.",-1))),Ce=We((()=>(0,s._)("br",null,null,-1))),Ve={class:"d-flex w-100 justify-content-between"},Se={class:"mb-1"};function Ie(e,t,o,r,l,n){const a=(0,s.up)("b-col"),d=(0,s.up)("b-button"),u=(0,s.up)("b-row"),c=(0,s.up)("b-container"),p=(0,s.up)("AdresseView"),m=(0,s.up)("b-list-group-item"),h=(0,s.up)("b-list-group");return(0,s.wg)(),(0,s.iD)("div",null,[Ue,(0,s.Wm)(h,{class:"scroll_list"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.rdvs,(e=>((0,s.wg)(),(0,s.j4)(m,{key:e.uuid,button:"",onClick:t=>n.rdvSelected(e),href:"#"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"fluid"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[void 0!=e.distance?((0,s.wg)(),(0,s.j4)(a,{key:0,cols:"3"},{default:(0,s.w5)((()=>[(0,s._)("small",null,(0,f.zw)(e.distance>1?Math.round(e.distance)+" km":Math.floor(1e3*e.distance)+" m"),1)])),_:2},1024)):(0,s.kq)("",!0),(0,s.Wm)(a,{cols:"5"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,f.zw)(e.title),1)])),_:2},1024),(0,s.Wm)(a,{cols:"4"},{default:(0,s.w5)((()=>[(0,s._)("small",null,[(0,s.Wm)(d,{variant:"success",onClick:(0,i.iM)((t=>n.ouvrir(e)),["stop"]),size:"sm"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,f.zw)(n.display(e.start))+" ",1),Ce,(0,s.Uk)(" "+(0,f.zw)(n.display(e.end)),1)])),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,s._)("div",Ve,[(0,s._)("small",null,(0,f.zw)(e.tags),1)]),(0,s._)("p",Se,[(0,s._)("small",null,(0,f.zw)(e.description),1)]),(0,s.Wm)(p,{coordinates:e.coordinates},null,8,["coordinates"])])),_:2},1032,["onClick"])))),128))])),_:1})])}function je(e,t,o,r,l,n){const a=(0,s.up)("b-button");return(0,s.wg)(),(0,s.j4)(a,{onClick:(0,i.iM)(n.ouvrir,["stop"]),variant:"primary",size:"sm"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,f.zw)(l.adresse),1)])),_:1},8,["onClick"])}var Oe={name:"AdresseView",props:["coordinates"],data(){return{adresse:null,adresseShow:!1}},mounted(){this.showAdresse()},methods:{async showAdresse(){this.adresseShow=!0;let e=await this.adress(this.coordinates),t=e.display_name.split(",");this.adresse=t[0]+" "+t[1]+" "+t[2]},async adress([e,t]){let o="https://nominatim.openstreetmap.org/reverse?lat="+t+"&lon="+e+"&format=json";console.log(o);let i=await fetch(o);return i.json()},ouvrir(){window.open("https://www.google.com/maps/search/?api=1&query="+this.adresse)}},computed:{}};const xe=(0,l.Z)(Oe,[["render",je]]);var Ee=xe,ze={name:"RdvView",components:{AdresseView:Ee},methods:{rdvSelected(e){this.$store.commit("core/centerToPoint",e.coordinates)},withDistances(e){let t=e.map((e=>{var t=Object.assign({},e);if(void 0!=e.coordinates&&void 0!=this.myPosition){const o=this.$getDistanceFromLatLonInKm(this.myPosition[0],this.myPosition[1],e.coordinates[0],e.coordinates[1]).toFixed(3);t.distance=o}return t}));return t.sort((function(e,t){return e.distance-t.distance}))},display(e){return new Date(e).toLocaleString()},ouvrir(e){let t="https://calendar.google.com/calendar/render?action=TEMPLATE&dates=";t+=new Date(e.start).toISOString().replace(/[^\w\s]/gi,"")+"/"+new Date(e.end).toISOString().replace(/[^\w\s]/gi,""),t+="&details="+e.description+"<br><br>"+e.tags,t+="&location="+e.coordinates[1]+","+e.coordinates[0],t+="&text="+e.title,window.open(t)}},computed:{rdvs(){return console.log("rdvs",this.rdvs),this.withDistances(this.$store.state.core.rdvs)},myPosition(){return this.$store.state.core.myPosition}}};const Me=(0,l.Z)(ze,[["render",Ie],["__scopeId","data-v-9f17f8e6"]]);var Te=Me;function Be(e,t,o,i,r,l){return(0,s.wg)(),(0,s.iD)("div")}var He=o(6866);(0,se.QB)(He);var Re={name:"RdvUpdater",created(){console.log("RDV CREATED !!!!!!!!!!!!!!!!!!!!!",ce),(0,se.QT)(de.rdvs,this.rdvsUpdate),(0,se.QT)(de.posts,this.postsUpdate)},methods:{rdvsUpdate(){let e=[];for(let[t,o]of Object.entries(de.rdvs)){let i=Date.parse(o.end),s=Date.now();if(console.log(o.title,o.end,i,s,i-s),i<s)return console.log("DELETE old rdv",t),void delete de.rdvs[t];e.push(o)}this.$store.commit("core/setRdvs",e)},postsUpdate(){let e=[];for(let[t,o]of Object.entries(de.posts)){let i=Date.now();if(console.log(o.title,o.end,i),o.end<i)return console.log("DELETE old post",t),void delete de.posts[t];e.unshift(o)}this.$store.commit("core/setPosts",e)},rdvsUpdate1(){let e=[];for(let[t,o]of Object.entries(de.rdvs))if(t!=ce.clientID){console.log("coordin",t,o.coordinates[0],o.coordinates[1],o.title),console.log("dates",t,o.end_date,o.end_time);let i=o.end_date+"T"+o.end_time;console.log("iso",i);let s=new Date(i),r=Date.now();console.log(r,s);let l=s.getTime()-r;if(l<0)return console.log("diff delete",l),void delete de.rdvs[t];void 0!=o.end_date&&void 0!=o.end_time?e.push(o):(console.log(t,"no end_date"),delete de.rdvs[t])}this.$store.commit("core/setRdvs",e)}}};const Fe=(0,l.Z)(Re,[["render",Be]]);var Ke=Fe;function Ze(e,t,o,i,r,l){return(0,s.wg)(),(0,s.iD)("span")}var qe={name:"UsersUpdater",data(){return{}},created(){ce.on("change",(e=>{console.log("--changes",e),this.updateUsers(Array.from(ce.getStates().values()).filter((e=>void 0!=e.profile&&e.profile.clientID!=ce.clientID)))})),this.updateUsers(Array.from(ce.getStates().values()).filter((e=>void 0!=e.profile&&e.profile.clientID!=ce.clientID)))},methods:{updateUsers(e){console.log("UPDATE USERS"),this.users=this.withDistances(e).sort((function(e,t){return e.distance-t.distance})),this.$store.commit("core/setUsers",this.users)},withDistances(e){let t=e.map((e=>{var t=Object.assign({},e);if(void 0!=e.position&&void 0!=this.myPosition){const o=this.$getDistanceFromLatLonInKm(this.myPosition[0],this.myPosition[1],e.position.coordinates[0],e.position.coordinates[1]).toFixed(3);t.distance=o}return t}));return t}},computed:{myPosition(){return this.$store.state.core.myPosition}}};const Ge=(0,l.Z)(qe,[["render",Ze]]);var $e=Ge;function Le(e,t,o,i,r,l){const n=(0,s.up)("BListGroupItem"),a=(0,s.up)("BListGroup");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,[0==l.places.length?((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>l.getWikipedia&&l.getWikipedia(...e))},"Afficher les endroits wikipedia voisins")):((0,s.wg)(),(0,s.iD)("button",{key:1,onClick:t[1]||(t[1]=(...e)=>l.hideWikipedia&&l.hideWikipedia(...e))},"Masquer les emplacements wikipedia"))]),l.places.length>0?((0,s.wg)(),(0,s.j4)(a,{key:0,class:"scroll_list"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.places,(e=>((0,s.wg)(),(0,s.j4)(n,{key:e.pageid,href:"#",onClick:t=>l.wikipediaClicked(e)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,f.zw)(e.title)+" à "+(0,f.zw)(e.dist)+" m ",1)])),_:2},1032,["onClick"])))),128))])])),_:1})):(0,s.kq)("",!0)])}var Ye={name:"WikipediaView",data(){return{}},methods:{async getWikipedia(){await this.$store.commit("core/getWikipedia")},hideWikipedia(){this.$store.commit("core/removeWikipedia")},wikipediaClicked(e){console.log(e),this.$store.commit("core/centerToPoint",[e.lon,e.lat])}},computed:{places(){return this.$store.state.core.places}}};const Je=(0,l.Z)(Ye,[["render",Le]]);var Ne=Je;function Qe(e,t,o,i,r,l){const n=(0,s.up)("b-button"),a=(0,s.up)("b-button-group");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(a,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{onClick:t[0]||(t[0]=e=>l.setView("rdv")),variant:"outline-primary",pressed:"rdv"==l.view},{default:(0,s.w5)((()=>[(0,s.Uk)("Rdv")])),_:1},8,["pressed"]),(0,s.Wm)(n,{onClick:t[1]||(t[1]=e=>l.setView("users")),variant:"outline-primary",pressed:"users"==l.view},{default:(0,s.w5)((()=>[(0,s.Uk)("Users")])),_:1},8,["pressed"]),(0,s.Wm)(n,{onClick:t[2]||(t[2]=e=>l.setView("post")),variant:"outline-primary",pressed:"post"==l.view},{default:(0,s.w5)((()=>[(0,s.Uk)("Post")])),_:1},8,["pressed"]),(0,s.Wm)(n,{onClick:t[3]||(t[3]=e=>l.setView("graph")),variant:"outline-primary",pressed:"graph"==l.view},{default:(0,s.w5)((()=>[(0,s.Uk)("graph")])),_:1},8,["pressed"]),(0,s.Wm)(n,{onClick:t[4]||(t[4]=e=>l.setView("wikipedia")),variant:"outline-primary",pressed:"wikipedia"==l.view},{default:(0,s.w5)((()=>[(0,s.Uk)("wkpedia")])),_:1},8,["pressed"]),(0,s.Wm)(n,{onClick:l.onShowProfile,variant:"outline-primary",pressed:"profile"==l.view},{default:(0,s.w5)((()=>[(0,s.Uk)(" Profil")])),_:1},8,["onClick","pressed"])])),_:1})])}var Xe={name:"MenuComponent",methods:{setView(e){this.$store.commit("core/setView",e)},onShowProfile(){this.$store.commit("core/setShowProfile",!0)}},computed:{view(){return this.$store.state.core.view}}};const et=(0,l.Z)(Xe,[["render",Qe]]);var tt=et;function ot(e,t,o,i,r,l){const n=(0,s.up)("b-form-input"),a=(0,s.up)("b-form-textarea"),d=(0,s.up)("b-card-text"),u=(0,s.up)("b-button"),c=(0,s.up)("b-card"),p=(0,s.up)("PostsList");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(c,{title:"Posts",tag:"article",class:"mb-2"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Do you think something ? Post it ! "),(0,s._)("div",null,[(0,s.Wm)(n,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.title=t),placeholder:"Titre"},null,8,["modelValue"]),(0,s.Wm)(a,{id:"textarea",modelValue:e.content,"onUpdate:modelValue":t[1]||(t[1]=t=>e.content=t),placeholder:"Dites quelque chose...",rows:"3","max-rows":"6"},null,8,["modelValue"]),(0,s.Wm)(n,{modelValue:e.tags,"onUpdate:modelValue":t[2]||(t[2]=t=>e.tags=t),placeholder:"tags comma separated"},null,8,["modelValue"])])])),_:1}),(0,s.Wm)(u,{href:"#",variant:"primary",onClick:l.sendPost},{default:(0,s.w5)((()=>[(0,s.Uk)("Envoyer")])),_:1},8,["onClick"])])),_:1}),(0,s.Wm)(p)])}const it={class:"d-flex w-100 justify-content-between"},st={class:"mb-1"},rt=(0,s._)("br",null,null,-1),lt={class:"mb-1"};function nt(e,t,o,i,r,l){const n=(0,s.up)("b-list-group-item"),a=(0,s.up)("b-list-group");return(0,s.wg)(),(0,s.j4)(a,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.posts,(e=>((0,s.wg)(),(0,s.j4)(n,{key:e.uuid,href:"#",class:"flex-column align-items-start"},{default:(0,s.w5)((()=>[(0,s._)("div",it,[(0,s._)("h5",st,(0,f.zw)(e.title),1),(0,s._)("small",null,[(0,s.Uk)("disparition : "+(0,f.zw)(new Date(e.end).toLocaleString())+" ",1),rt,(0,s.Uk)("auteur: "+(0,f.zw)(e.author),1)])]),(0,s._)("p",lt,(0,f.zw)(e.content),1),(0,s._)("small",null,(0,f.zw)(e.tags),1)])),_:2},1024)))),128))])),_:1})}var at={name:"PostsList",computed:{posts(){return this.$store.state.core.posts}}};const dt=(0,l.Z)(at,[["render",nt]]);var ut=dt,ct={name:"PostView",components:{PostsList:ut},data:function(){return{title:"",content:"",tags:""}},methods:{sendPost:function(){let e=new Date,t=e.setDate(e.getDate()+7),o={title:this.title,content:this.content,tags:this.tags,end:t};this.$store.dispatch("core/updateYstorePosts",o),this.title="",this.content="",this.tags=""}}};const pt=(0,l.Z)(ct,[["render",ot]]);var mt=pt;const ft=e=>((0,s.dD)("data-v-430aaf66"),e=e(),(0,s.Cn)(),e),ht=ft((()=>(0,s._)("hr",null,null,-1))),vt=ft((()=>(0,s._)("hr",null,null,-1))),gt={ref:"graph"},wt=ft((()=>(0,s._)("hr",null,null,-1)));function kt(e,t,o,i,r,l){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Uk)(" rdvs : "+(0,f.zw)(l.rdvs)+" ",1),ht,(0,s.Uk)(" users: "+(0,f.zw)(l.users)+" ",1),vt,(0,s.Uk)(" posts: "+(0,f.zw)(l.posts)+" ",1),(0,s._)("div",gt,null,512),(0,s.Uk)(" "+(0,f.zw)(null!=l.coreCurrent&&l.coreCurrent.id)+"  nodes : "+(0,f.zw)(r.nodes)+" ",1),wt])}var At=o(7400),bt=o(5209),yt=o(6084),_t=o(7809),Pt={name:"GraphView",data(){return{ystore:de,graph:null,nodes:[],links:[]}},mounted(){this.init()},methods:{init(){let e=this.graph=(0,At.Z)({extraRenderers:[new bt.M]})(this.$refs.graph).width(100).nodeLabel("name").backgroundColor("#0B0B61").height(window.innerHeight-64).nodeThreeObject((e=>{const t=document.createElement("div");return t.textContent=e["name"],t.style.color="#cccccc",t.className="node-label",new bt.j(t)})).nodeThreeObjectExtend(!0).onNodeClick((e=>this.focus(e))).nodeAutoColorBy("group").linkDirectionalArrowLength(3.5).linkDirectionalArrowRelPos(1).linkCurvature(.25).linkThreeObjectExtend(!0).linkThreeObject((e=>{const t=new _t.Z(`${e.name}`);return t.color="lightgrey",t.textHeight=1.5,t})).linkPositionUpdate(((e,{start:t,end:o})=>{const i=Object.assign(...["x","y","z"].map((e=>({[e]:t[e]+(o[e]-t[e])/2}))));Object.assign(e.position,i)}));function t(){e.height(window.innerHeight-64)}this.graph.graphData({nodes:this.nodes,links:this.links}),yt().listenTo(this.$refs.graph,(e=>{this.graph.width(e.offsetWidth)})),window.onresize=t,this.rdvs=this.$store.state.core.rdvs,this.updateGraph()},focus(e){console.log("focus",e),this.$store.commit("core/setCoreCurrent",e);const t=40,o=1+t/Math.hypot(e.x,e.y,e.z),i=e.x||e.y||e.z?{x:e.x*o,y:e.y*o,z:e.z*o}:{x:0,y:0,z:t};this.graph.cameraPosition(i,e,3e3)},updateGraph(){this.rdvs.forEach((e=>{console.log(e);let t=this.nodes.find((t=>t.id==e.uuid));null==t?this.nodes.push({id:e.uuid,name:e.title,group:"rdv"}):console.log("should update node rdv",t)})),this.users.forEach((e=>{console.log(e);let t=this.nodes.find((t=>t.id==e.uuid));null==t?this.nodes.push({id:e.uuid,name:e.name,group:"user"}):console.log("should update node user",t)})),this.posts.forEach((e=>{console.log(e);let t=this.nodes.find((t=>t.id==e.uuid));null==t?this.nodes.push({id:e.uuid,name:e.title,group:"post"}):console.log("should update node post",t)})),this.graph.graphData({nodes:this.nodes,links:this.links})}},watch:{rdvs(){this.updateGraph()},users(){this.updateGraph()},posts(){this.updateGraph()},coreCurrent(){if(null!=this.coreCurrent){let e=this.nodes.find((e=>e.id==this.coreCurrent.id));this.focus(e)}}},computed:{coreCurrent(){return this.$store.state.core.coreCurrent},rdvs(){return this.$store.state.core.rdvs},users(){return this.$store.state.core.users},posts(){return this.$store.state.core.posts}}};const Dt=(0,l.Z)(Pt,[["render",kt],["__scopeId","data-v-430aaf66"]]);var Wt=Dt,Ut={name:"MapView",components:{WorldMap:F,ProfileView:ve,UsersView:De,RdvView:Te,RdvUpdater:Ke,UsersUpdater:$e,WikipediaView:Ne,MenuComponent:tt,PostView:mt,GraphView:Wt},computed:{view(){return this.$store.state.core.view},users(){return this.$store.state.core.users},rdvs(){return this.$store.state.core.rdvs},places(){return this.$store.state.core.places}}};const Ct=(0,l.Z)(Ut,[["render",m]]);var Vt=Ct;const St=[{path:"/",name:"home",component:Vt},{path:"/about",name:"about",component:()=>o.e(443).then(o.bind(o,2995))}],It=(0,c.p7)({history:(0,c.PO)("/rdv/"),routes:St});var jt=It,Ot=o(3029);const xt=()=>({level:0,profiles:[],profile:null,myPosition:[],users:[],centerPoint:null,view:"rdv",rdvs:[],rdv:null,positionUpdated:null,wikipedia_api_url:"https://fr.wikipedia.org/w/api.php?origin=*",places:[],showProfile:!1,posts:[],wikipedia_params:{action:"query",list:"geosearch",gscoord:null,prop:"coordinates|pageimages",gsradius:1e4,gslimit:100,format:"json"}}),Et={setShowProfile(e,t){e.showProfile=t},async updateMyPosition(e,t){console.log("position update",t),e.myPosition=t,console.log("delay ",Date.now()-e.positionUpdated),Date.now()-e.positionUpdated>1e4&&(e.positionUpdated=Date.now(),ce.setLocalStateField("position",{coordinates:t,updated:e.positionUpdated}))},async getWikipedia(e){let t=await this.dispatch("core/getWikipedia",e.myPosition);console.log(t),e.places=t},async removeWikipedia(e){e.places=[]},setUsers(e,t){e.users=t},setRdv(e,t){void 0==t.uuid&&(t.uuid=(0,Ot.Z)()),void 0==t.author&&(t.author=ce.clientID),e.rdv=t},setProfiles(e,t){e.profiles=t},setProfile(e,t){e.profile=t},centerToPoint(e,t){e.centerPoint=t},addProfile(e,t){t.id=(0,Ot.Z)(),e.profiles.push(t)},setView(e,t){e.view=t},setRdvs(e,t){e.rdvs=t},setPosts(e,t){e.posts=t}},zt={increment(e,t){e.commit("increment",t)},updateYstoreRdvs(e,t){de.rdvs[t.uuid]=t},updateYstorePosts(e,t){void 0==t.uuid&&(t.uuid=(0,Ot.Z)()),void 0==t.author&&(t.author=ce.clientID),de.posts[t.uuid]=t},async getWikipedia(e,t){let o=e.state.wikipedia_params,i=e.state.wikipedia_api_url;return o.gscoord=t[1]+"|"+t[0],Object.keys(o).forEach((function(e){i+="&"+e+"="+o[e]})),console.log("url",i),fetch(i).then((function(e){return console.log(e),e.json()})).then((e=>(console.log(e),e.query.geosearch))).catch((function(e){console.log(e)}))}};var Mt={namespaced:!0,state:xt,actions:zt,mutations:Et},Tt=(0,v.MT)({state:{},getters:{},mutations:{},actions:{},modules:{core:Mt}}),Bt={install(e,t){console.log(e,t);let o=t.store;console.log(o),e.config.globalProperties.$getDistanceFromLatLonInKm=(t,o,i,s)=>{var r=6371,l=e.config.globalProperties.$deg2rad(i-t),n=e.config.globalProperties.$deg2rad(s-o),a=Math.sin(l/2)*Math.sin(l/2)+Math.cos(e.config.globalProperties.$deg2rad(t))*Math.cos(e.config.globalProperties.$deg2rad(i))*Math.sin(n/2)*Math.sin(n/2),d=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),u=r*d;return u},e.config.globalProperties.$deg2rad=e=>e*(Math.PI/180)}},Ht=o(2026),Rt=o(8784);(0,i.ri)(d).use(Tt).use(jt).use(Ht.ZP).use(de).use(Bt,{store:Tt}).use(Rt.ZP).mount("#app")}},t={};function o(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,i,s,r){if(!i){var l=1/0;for(u=0;u<e.length;u++){i=e[u][0],s=e[u][1],r=e[u][2];for(var n=!0,a=0;a<i.length;a++)(!1&r||l>=r)&&Object.keys(o.O).every((function(e){return o.O[e](i[a])}))?i.splice(a--,1):(n=!1,r<l&&(l=r));if(n){e.splice(u--,1);var d=s();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,s,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,i){return o.f[i](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/about.dfe66140.js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="rdv:";o.l=function(i,s,r,l){if(e[i])e[i].push(s);else{var n,a;if(void 0!==r)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==i||c.getAttribute("data-webpack")==t+r){n=c;break}}n||(a=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,o.nc&&n.setAttribute("nonce",o.nc),n.setAttribute("data-webpack",t+r),n.src=i),e[i]=[s];var p=function(t,o){n.onerror=n.onload=null,clearTimeout(m);var s=e[i];if(delete e[i],n.parentNode&&n.parentNode.removeChild(n),s&&s.forEach((function(e){return e(o)})),t)return t(o)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=p.bind(null,n.onerror),n.onload=p.bind(null,n.onload),a&&document.head.appendChild(n)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/rdv/"}(),function(){var e={143:0};o.f.j=function(t,i){var s=o.o(e,t)?e[t]:void 0;if(0!==s)if(s)i.push(s[2]);else{var r=new Promise((function(o,i){s=e[t]=[o,i]}));i.push(s[2]=r);var l=o.p+o.u(t),n=new Error,a=function(i){if(o.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var r=i&&("load"===i.type?"missing":i.type),l=i&&i.target&&i.target.src;n.message="Loading chunk "+t+" failed.\n("+r+": "+l+")",n.name="ChunkLoadError",n.type=r,n.request=l,s[1](n)}};o.l(l,a,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,r,l=i[0],n=i[1],a=i[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(a)var u=a(o)}for(t&&t(i);d<l.length;d++)r=l[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},i=self["webpackChunkrdv"]=self["webpackChunkrdv"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=o.O(void 0,[998],(function(){return o(609)}));i=o.O(i)})();
//# sourceMappingURL=app.eeb5234b.js.map