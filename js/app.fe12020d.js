(function(){var e={444:function(e,t,o){"use strict";var r=o(9242),n=o(3396);function i(e,t){const o=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(o)}var l=o(89);const s={},a=(0,l.Z)(s,[["render",i]]);var d=a,u=o(5431);(0,u.z)("/rdv/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh."),alert("This app has been updated, please close the app & re-open")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var c=o(2483);const p={class:"home"};function m(e,t,o,r,i,l){const s=(0,n.up)("MapComponent"),a=(0,n.up)("ProfileView"),d=(0,n.up)("UsersView"),u=(0,n.up)("RdvView"),c=(0,n.up)("RdvUpdater");return(0,n.wg)(),(0,n.iD)("div",p,[(0,n.Wm)(s),(0,n.Wm)(a),"users"==l.view?((0,n.wg)(),(0,n.j4)(d,{key:0})):(0,n.kq)("",!0),"rdv"==l.view?((0,n.wg)(),(0,n.j4)(u,{key:1})):(0,n.kq)("",!0),(0,n.Wm)(c)])}const f={for:"datePicker"},h=(0,n._)("code",null,"When ?",-1),v={key:0},w=(0,n._)("i",null,"7 days max",-1),g=[w],k={role:"group"},_=(0,n._)("label",{for:"input-live"},[(0,n._)("code",null,"Title:")],-1),y=(0,n._)("label",{for:"textarea"},[(0,n._)("code",null,"Description:")],-1),b=(0,n._)("label",{for:"color"},[(0,n._)("code",null,"Color:")],-1),A=(0,n._)("label",{for:"password"},[(0,n._)("code",null,"Password:")],-1);function W(e,t,o,r,i,l){const s=(0,n.up)("ol-view"),a=(0,n.up)("ol-source-osm"),d=(0,n.up)("ol-tile-layer"),u=(0,n.up)("ol-style-fill"),c=(0,n.up)("ol-style-stroke"),p=(0,n.up)("ol-style-text"),m=(0,n.up)("ol-style-circle"),w=(0,n.up)("ol-style"),W=(0,n.up)("ol-interaction-select"),P=(0,n.up)("ol-geom-point"),C=(0,n.up)("ol-style-icon"),D=(0,n.up)("ol-feature"),I=(0,n.up)("ol-source-vector"),S=(0,n.up)("ol-vector-layer"),M=(0,n.up)("ol-geolocation"),U=(0,n.up)("ol-context-menu-control"),V=(0,n.up)("ol-geom-multi-point"),O=(0,n.up)("ol-map"),x=(0,n.up)("VueDatePicker"),T=(0,n.up)("b-form-input"),j=(0,n.up)("b-form-invalid-feedback"),B=(0,n.up)("b-form-text"),E=(0,n.up)("b-form-textarea"),L=(0,n.up)("b-col"),z=(0,n.up)("b-row"),K=(0,n.up)("BModal");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(O,{loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,style:{height:"400px"},ref:"map"},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{ref:"view",center:i.center,rotation:i.rotation,zoom:i.zoom,projection:i.projection},null,8,["center","rotation","zoom","projection"]),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(a)])),_:1}),(0,n.Wm)(W,{onSelect:l.featureSelected},{default:(0,n.w5)((()=>[(0,n.Wm)(w,null,{default:(0,n.w5)((()=>[(0,n.Wm)(m,{radius:2*i.radius},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{color:"green"}),(0,n.Wm)(c,{color:"red",width:i.strokeWidth},null,8,["width"]),(0,n.Wm)(p,{text:"selected"})])),_:1},8,["radius"])])),_:1})])),_:1},8,["onSelect"]),(0,n.Wm)(M,{projection:i.projection,"onChange:position":l.geoLocChange},{default:(0,n.w5)((()=>[(0,n._)("template",null,[(0,n.Wm)(S,{zIndex:2},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D,{ref:"positionFeature"},{default:(0,n.w5)((()=>[(0,n.Wm)(P,{coordinates:i.position},null,8,["coordinates"]),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>[(0,n.Wm)(C,{src:i.hereIcon,scale:.1},null,8,["src"])])),_:1})])),_:1},512)])),_:1})])),_:1})])])),_:1},8,["projection","onChange:position"]),(0,n.Wm)(U,{items:i.contextMenuItems},null,8,["items"]),(0,n.Wm)(S,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,{ref:"markers"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,null,{default:(0,n.w5)((()=>[(0,n.Wm)(C,{src:i.marker,scale:.05},null,8,["src"])])),_:1})])),_:1},512)])),_:1}),(0,n.Wm)(S,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.users,((e,t)=>((0,n.wg)(),(0,n.j4)(D,{key:t},{default:(0,n.w5)((()=>[void 0!=e.position?((0,n.wg)(),(0,n.j4)(V,{key:0,coordinates:e.position.coordinates},null,8,["coordinates"])):(0,n.kq)("",!0),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>[(0,n.Wm)(m,{radius:i.radius},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{color:i.fillColor},null,8,["color"]),(0,n.Wm)(c,{color:e.profile.color,width:i.strokeWidth},null,8,["color","width"]),(0,n.Wm)(p,{text:e.profile.name},null,8,["text"])])),_:2},1032,["radius"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,n.Wm)(S,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.rdvs,(e=>((0,n.wg)(),(0,n.j4)(D,{key:e.uuid},{default:(0,n.w5)((()=>[void 0!=e.coordinates?((0,n.wg)(),(0,n.j4)(V,{key:0,coordinates:e.coordinates},null,8,["coordinates"])):(0,n.kq)("",!0),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>[(0,n.Wm)(C,{src:i.marker,scale:.05},null,8,["src"]),(0,n.Wm)(p,{text:e.title},null,8,["text"]),(0,n.Wm)(c,{color:e.color||"yellow",width:i.strokeWidth},null,8,["color","width"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1},512),(0,n.Wm)(K,{modelValue:i.modal,"onUpdate:modelValue":t[5]||(t[5]=e=>i.modal=e),onOk:l.onAddRdv,size:"lg"},{default:(0,n.w5)((()=>[(0,n._)("label",f,[h,(0,n.Uk)(),1==i.edit?((0,n.wg)(),(0,n.iD)("small",v,g)):(0,n.kq)("",!0)]),(0,n.Wm)(x,{id:"datePicker",modelValue:i.date,"onUpdate:modelValue":t[0]||(t[0]=e=>i.date=e),range:"","partial-range":"","max-range":"7","format-locale":i.fr,format:"Pp","min-date":new Date,"max-date":new Date((new Date).setDate((new Date).getDate()+15)),disabled:!i.edit},null,8,["modelValue","format-locale","min-date","max-date","disabled"]),(0,n._)("div",k,[_,(0,n.Wm)(T,{id:"input-live",modelValue:i.rdv.title,"onUpdate:modelValue":t[1]||(t[1]=e=>i.rdv.title=e),state:i.stateTitle,onInput:l.titleState,disabled:!i.edit,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Title",trim:""},null,8,["modelValue","state","onInput","disabled"]),(0,n.Wm)(j,{id:"input-live-feedback"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Enter at least 3 and less than 50 letters ")])),_:1}),(0,n.Wm)(B,{id:"input-live-help"},{default:(0,n.w5)((()=>[(0,n.Uk)("A cool title for your event.")])),_:1})]),y,(0,n.Wm)(E,{id:"textarea",modelValue:i.rdv.description,"onUpdate:modelValue":t[2]||(t[2]=e=>i.rdv.description=e),placeholder:"Description",rows:"3","max-rows":"6",disabled:!i.edit},null,8,["modelValue","disabled"]),(0,n.Wm)(z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[b,(0,n.Wm)(T,{id:"color",modelValue:i.rdv.color,"onUpdate:modelValue":t[3]||(t[3]=e=>i.rdv.color=e),disabled:!i.edit,type:"color"},null,8,["modelValue","disabled"])])),_:1}),(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[A,(0,n.Wm)(T,{id:"password",modelValue:i.password,"onUpdate:modelValue":t[4]||(t[4]=e=>i.password=e),placeholder:"password protect",type:"password"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue","onOk"])])}var P=o(7676),C=o(5469),D=o(7548),I=o(2108),S=o(8014),M=o(9002),U=o.n(M),V=o(1586),O=o.n(V),x=o(1508),T=o(2949),j=o(1330),B=o(3029),E={name:"MapComponent",components:{VueDatePicker:I.Z},data(){return{initialisation:!0,center:[47.41322,-1.219482],rotation:0,zoom:14,projection:"EPSG:4326",position:[],hereIcon:C,marker:P,radius:10,strokeWidth:4,strokeColor:"red",fillColor:"white",coordinates:[],contextMenuItems:null,rdv:{},edit:!1,modal:!1,inputFields:[{id:"title",name:"Title",type:"text"},{id:"desc",name:"Description",type:"text"},{id:"color",name:"Color",type:"color"},{id:"start_date",name:"Start Date",type:"date",min:(new Date).toISOString().split("T")[0]},{id:"start_time",name:"Start Time",type:"time"},{id:"end_date",name:"End Date",type:"date",min:(new Date).toISOString().split("T")[0]},{id:"end_time",name:"End Time",type:"time"}],fr:S.Z,stateTitle:!1,date:null,password:null}},created(){this.initContextMenu()},methods:{titleState(){this.stateTitle=1!=this.edit||this.rdv.title.length>2&&this.rdv.title.length<51},initContextMenu(){let e=this;this.contextMenuItems=[{text:"Center map here",classname:"some-style-class",callback:t=>{e.$refs.view.setCenter(t.coordinate)}},{text:"Add a rdv",classname:"some-style-class",icon:D,callback:t=>{e.rdv={uuid:(0,B.Z)(),author:j.kW.clientID,coordinates:t.coordinate,start_date:(new Date).toISOString().split("T")[0],end_date:(new Date).toISOString().split("T")[0],start_time:"00:00",end_time:"23:59"},e.edit=!0,e.modal=!0}},{text:"Add a Marker",classname:"some-style-class",icon:P,callback:t=>{console.log(t);const o=new x.Z({geometry:new T.Z(t.coordinate)});console.log("new feature",o),e.$refs.markers.source.addFeature(o)}},"-"]},onAddRdv(){console.log(this.date),null==this.date[1]&&(this.date[1]=this.date[0]),this.rdv.start_date=this.date[0].toLocaleDateString(),this.rdv.start_time=this.date[0].toLocaleTimeString(),this.rdv.end_date=this.date[1].toLocaleDateString(),this.rdv.end_time=this.date[1].toLocaleTimeString(),this.rdv.password=O().stringify(U()(this.password)),this.password="",console.log(this.rdv),this.rdv.updated=Date.now();const e=new x.Z({geometry:new T.Z(this.rdv.coordinates),data:this.rdv});1==this.edit&&(this.$refs.markers.source.addFeature(e),j.h.rdvs[this.rdv.uuid]=this.rdv)},featureSelected(e){if(console.log("feature selected",e.selected,e.target),e.selected.length>0){let t=e.selected[0].get("uuid");console.log("selected",e.selected[0],t)}},geoLocChange(e){this.position=e.target.getPosition(),this.$store.commit("core/updateMyPosition",this.position),1==this.centerMe&&this.$refs.view.setCenter(this.position),j.kW.setLocalStateField("position",{coordinates:this.position,updated:Date.now()})},userMapClicked(e){console.log(e)}},watch:{centerMe(){1==this.centerMe&&(console.log("center me",this.centerMe),this.$refs.view.setCenter(this.position))},centerPoint(){console.log(this.centerPoint),this.$refs.view.setCenter(this.centerPoint)}},computed:{users(){return this.$store.state.core.users},rdvs(){return this.$store.state.core.rdvs},centerMe(){return this.$store.state.core.centerMe},centerPoint(){return this.$store.state.core.centerPoint}}};const L=(0,l.Z)(E,[["render",W]]);var z=L,K=o(7139);const Z={class:"row"},F=(0,n._)("label",{class:"col-form-label col-2",for:"inline-form-input-name"},"Nom",-1),q={class:"col-8"},N={class:"col-2"},R={class:"row"},$=(0,n._)("label",{class:"col-form-label col-2",for:"inline-form-input-profile"},"Profil",-1),G={class:"col-8"},J={class:"col-2"},H={style:{"margin-bottom":"30px"}},Y=["onClick"],Q={key:0,class:"row"},X=(0,n._)("label",{class:"col-form-label col-2",for:"inline-form-input-profile"},"intérêt",-1),ee={class:"col-8"},te={class:"col-2"};function oe(e,t,o,i,l,s){const a=(0,n.up)("BButton"),d=(0,n.up)("b-button-group"),u=(0,n.up)("b-button"),c=(0,n.up)("BFormInput"),p=(0,n.up)("BListGroupItem"),m=(0,n.up)("BListGroup"),f=(0,n.up)("BForm"),h=(0,n.up)("BModal");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(a,{onClick:t[0]||(t[0]=e=>l.showProfile=!l.showProfile),variant:"info"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Profil")])),_:1}),(0,n.Wm)(a,{onClick:s.followMe,variant:1==s.centerMe?"outline-warning":"outline-success"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,K.zw)(1==s.centerMe?"don't follow me":"follow me"),1)])),_:1},8,["onClick","variant"])])),_:1}),(0,n.Uk)("    "),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,{onClick:t[1]||(t[1]=e=>s.setView("users"))},{default:(0,n.w5)((()=>[(0,n.Uk)("Users")])),_:1}),(0,n.Wm)(u,{onClick:t[2]||(t[2]=e=>s.setView("rdv"))},{default:(0,n.w5)((()=>[(0,n.Uk)("Rdv")])),_:1})])),_:1}),(0,n.Wm)(h,{modelValue:l.showProfile,"onUpdate:modelValue":t[7]||(t[7]=e=>l.showProfile=e),onOk:s.updateUser},{default:(0,n.w5)((()=>[(0,n.Wm)(f,null,{default:(0,n.w5)((()=>[(0,n._)("div",Z,[F,(0,n._)("div",q,[(0,n.Wm)(c,{id:"inline-form-input-name",class:"mb-2 me-sm-2 mb-sm-0",modelValue:l.user.name,"onUpdate:modelValue":t[3]||(t[3]=e=>l.user.name=e),placeholder:"username"},null,8,["modelValue"])]),(0,n._)("div",N,[(0,n.Wm)(c,{modelValue:l.user.color,"onUpdate:modelValue":t[4]||(t[4]=e=>l.user.color=e),type:"color"},null,8,["modelValue"])])]),(0,n._)("div",R,[$,(0,n._)("div",G,[(0,n.Wm)(c,{id:"inline-form-input-profile",modelValue:l.profile_name,"onUpdate:modelValue":t[5]||(t[5]=e=>l.profile_name=e),placeholder:"profile name",onKeyup:(0,r.D2)(s.addProfile,["enter"])},null,8,["modelValue","onKeyup"])]),(0,n._)("div",J,[(0,n.Wm)(a,{onClick:s.addProfile},{default:(0,n.w5)((()=>[(0,n.Uk)(" +")])),_:1},8,["onClick"])])]),(0,n.Uk)(" "+(0,K.zw)(s.profile)+" ",1),(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.profiles,(e=>((0,n.wg)(),(0,n.j4)(p,{key:e.id,href:"#",active:s.profile==e.id,onClick:t=>s.changeProfile(e.id)},{default:(0,n.w5)((()=>[(0,n._)("h6",H,(0,K.zw)(e.name),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.interests,(t=>((0,n.wg)(),(0,n.iD)("button",{key:t,type:"button",class:"btn btn-dark position-relative",style:{"margin-right":"'5px'"}},[(0,n.Uk)((0,K.zw)(t)+" ",1),(0,n._)("span",{class:"position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle",onClick:o=>s.remove_interest({profil:e.id,interest:t})}," X ",8,Y)])))),128)),e.interests.length<5?((0,n.wg)(),(0,n.iD)("div",Q,[X,(0,n._)("div",ee,[(0,n.Wm)(c,{modelValue:l.new_interest,"onUpdate:modelValue":t[6]||(t[6]=e=>l.new_interest=e),value:l.new_interest,placeholder:"nouvel interêt",onKeyup:(0,r.D2)((t=>s.addInteret({profil:e.id})),["enter"])},null,8,["modelValue","value","onKeyup"])]),(0,n._)("div",te,[(0,n.Wm)(a,{onClick:t=>s.addInteret({profil:e.id})},{default:(0,n.w5)((()=>[(0,n.Uk)(" +")])),_:2},1032,["onClick"])])])):(0,n.kq)("",!0)])),_:2},1032,["active","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue","onOk"])])}o(7658);var re={name:"ProfileView",data(){return{showProfile:!1,user:{name:"user_"+Date.now(),color:"#ffb61e",clientID:j.kW.clientID},profile_name:"",interests:"",new_interest:""}},created(){let e=JSON.parse(localStorage.getItem("rdv_user"));if(console.log("localstorage user",e),e&&e.name&&e.color){this.user=e;let t=JSON.parse(localStorage.getItem("rdv_user_interests"));void 0!=t&&(console.log("from localstorage",t.profiles,t.profile),this.$store.commit("core/setProfiles",t.profiles),this.$store.commit("core/setProfile",t.profile))}j.kW.setLocalStateField("profile",this.user),this.updateInterests()},methods:{addInteret(e){if(this.new_interest.trim().length>0){console.log(this.new_interest,e);let t=this.profiles.find((t=>t.id==e.profil));t.interests.push(this.new_interest),this.new_interest="",console.log(t)}else alert("Ajoutez un centre d'intérêts")},remove_interest(e){console.log("remove",e.interest);let t=this.profiles.find((t=>t.id==e.profil));t.interests=t.interests.filter((t=>t!=e.interest))},onInputEventHandler(e){console.log(e),console.log(this.interests)},addProfile(){if(this.profile_name.trim().length>0){let e={name:this.profile_name,interests:[]};this.$store.commit("core/addProfile",e),this.profile_name=""}else alert("ajoutez un nom de profil")},setView(e){console.log("add rdv"),this.$store.commit("core/setView",e)},updateUser(){console.log("User",this.user),j.kW.setLocalStateField("profile",this.user),localStorage.setItem("rdv_user",JSON.stringify(this.user)),this.updateInterests()},changeProfile(e){console.log(e),this.$store.commit("core/setProfile",e)},updateInterests(){console.log("update interests"),j.kW.setLocalStateField("interests",{like:this.profiles.find((e=>e.id==this.profile))}),localStorage.setItem("rdv_user_interests",JSON.stringify({profiles:this.profiles,profile:this.profile}))},followMe(){console.log(this.centerMe),this.$store.commit("core/centerMe",!this.centerMe)}},watch:{profiles(){this.updateInterests()},profile(){this.updateInterests()}},computed:{profiles(){return this.$store.state.core.profiles},profile(){return this.$store.state.core.profile},centerMe(){return this.$store.state.core.centerMe}}};const ne=(0,l.Z)(re,[["render",oe]]);var ie=ne;const le={class:"row"},se={class:"col"},ae={class:"col"},de={class:"col"},ue={key:0},ce={key:1};function pe(e,t,o,r,i,l){const s=(0,n.up)("BBadge"),a=(0,n.up)("BListGroupItem"),d=(0,n.up)("BListGroup");return(0,n.wg)(),(0,n.iD)("div",null,[i.users.length>0?((0,n.wg)(),(0,n.j4)(d,{key:0,class:"users_list"},{default:(0,n.w5)((()=>[(0,n._)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.users,(e=>((0,n.wg)(),(0,n.j4)(a,{key:e.profile.clientID,href:"#",onClick:t=>l.userClicked(e)},{default:(0,n.w5)((()=>[(0,n._)("h2",null,(0,K.zw)(e.profile.name),1),(0,n._)("div",le,[(0,n._)("div",se,[(0,n._)("div",{class:"user_color",style:(0,K.j5)("width:20px;height:20px;background-color:"+e.profile.color)},null,4)]),(0,n._)("div",ae,(0,K.zw)(e.distance>1?e.distance+" km":Math.floor(1e3*e.distance)+" m"),1),(0,n._)("div",de,[void 0!=e.interests&&void 0!=e.interests.like&&void 0!=e.interests.like.interests&&l.profiles.length>0?((0,n.wg)(),(0,n.iD)("div",ue,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.interests.like.interests,(e=>((0,n.wg)(),(0,n.j4)(s,{key:e,variant:l.getInterestVariant(e)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,K.zw)(e),1)])),_:2},1032,["variant"])))),128))])):(0,n.kq)("",!0)])])])),_:2},1032,["onClick"])))),128))])])),_:1})):((0,n.wg)(),(0,n.iD)("div",ce," Recherche des voisins "))])}var me={name:"UsersView",data(){return{users:[],awareness:j.kW}},created(){j.kW.on("change",(()=>{this.updateUsers(Array.from(j.kW.getStates().values()).filter((e=>void 0!=e.profile&&e.profile.clientID!=j.kW.clientID)))}))},methods:{userClicked(e){console.log(e),void 0!=e.position&&this.$store.commit("core/centerToPoint",e.position.coordinates)},updateUsers(e){console.log("UPDATE USERS",e),this.users=this.withDistances(e).sort((function(e,t){return e.distance-t.distance})),this.$store.commit("core/setUsers",this.users)},withDistances(e){let t=e.map((e=>{var t=Object.assign({},e);if(void 0!=e.position){const o=this.getDistanceFromLatLonInKm(this.myPosition[0],this.myPosition[1],e.position.coordinates[0],e.position.coordinates[1]).toFixed(3);t.distance=o}return t}));return t},getDistanceFromLatLonInKm(e,t,o,r){var n=6371,i=this.deg2rad(o-e),l=this.deg2rad(r-t),s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(this.deg2rad(e))*Math.cos(this.deg2rad(o))*Math.sin(l/2)*Math.sin(l/2),a=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),d=n*a;return d},deg2rad(e){return e*(Math.PI/180)},getInterestVariant(e){let t=this.profiles.find((e=>e.id==this.profile));return void 0!=t&&t.interests.includes(e)?"info":"light"}},computed:{myPosition(){return this.$store.state.core.myPosition},profiles(){return this.$store.state.core.profiles},profile(){return this.$store.state.core.profile}}};const fe=(0,l.Z)(me,[["render",pe],["__scopeId","data-v-5a7674c0"]]);var he=fe;const ve=(0,n._)("br",null,null,-1);function we(e,t,o,r,i,l){const s=(0,n.up)("BListGroupItem"),a=(0,n.up)("BListGroup");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Uk)(" [[ display calendar]] "),(0,n.Wm)(a,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.rdvs,(e=>((0,n.wg)(),(0,n.j4)(s,{key:e.uuid,button:"",onClick:t=>l.rdvSelected(e)},{default:(0,n.w5)((()=>[(0,n._)("h4",null,(0,K.zw)(e.title),1),(0,n._)("small",null,(0,K.zw)(e.start_date)+" "+(0,K.zw)(e.start_time)+" -> "+(0,K.zw)(e.end_date)+" "+(0,K.zw)(e.end_time),1),ve,(0,n.Uk)(" "+(0,K.zw)(e.description),1)])),_:2},1032,["onClick"])))),128))])),_:1})])}var ge={name:"RdvView",created(){},methods:{rdvSelected(e){this.$store.commit("core/centerToPoint",e.coordinates)}},computed:{rdvs(){return this.$store.state.core.rdvs}}};const ke=(0,l.Z)(ge,[["render",we]]);var _e=ke;function ye(e,t,o,r,i,l){return(0,n.wg)(),(0,n.iD)("div")}var be=o(6866),Ae=o(5288);(0,Ae.QB)(be);var We={name:"RdvUpdater",created(){console.log("RDV CREATED !!!!!!!!!!!!!!!!!!!!!",j.kW),(0,Ae.QT)(j.h.rdvs,this.rdvsUpdate)},methods:{rdvsUpdate(){let e=[];for(let[t,o]of Object.entries(j.h.rdvs))if(t!=j.kW.clientID){console.log("coordin",t,o.coordinates[0],o.coordinates[1],o.title),console.log("dates",t,o.end_date,o.end_time);let r=o.end_date+"T"+o.end_time+":00Z",n=new Date(r),i=Date.now();console.log(i,n);let l=n.getTime()-i;if(l<0)return void delete j.h.rdvs[t];void 0!=o.end_date&&void 0!=o.end_time?e.push(o):(console.log(t,"no end_date"),delete j.h.rdvs[t])}this.$store.commit("core/setRdvs",e)}}};const Pe=(0,l.Z)(We,[["render",ye]]);var Ce=Pe,De={name:"MapView",components:{MapComponent:z,ProfileView:ie,UsersView:he,RdvView:_e,RdvUpdater:Ce},computed:{view(){return this.$store.state.core.view}}};const Ie=(0,l.Z)(De,[["render",m]]);var Se=Ie;const Me=[{path:"/",name:"home",component:Se},{path:"/about",name:"about",component:()=>o.e(443).then(o.bind(o,5481))}],Ue=(0,c.p7)({history:(0,c.PO)("/rdv/"),routes:Me});var Ve=Ue,Oe=o(65);const xe=()=>({level:0,profiles:[],profile:null,myPosition:[],users:[],centerMe:!0,centerPoint:[],view:"users",rdvs:[]}),Te={incrementLevel(e){e.level=e.level+1,console.log(e.level)},updateMyPosition(e,t){e.myPosition=t},setUsers(e,t){e.users=t},setProfiles(e,t){e.profiles=t},setProfile(e,t){e.profile=t},centerMe(e,t){e.centerMe=t},centerToPoint(e,t){e.centerPoint=t},addProfile(e,t){t.id=(0,B.Z)(),e.profiles.push(t)},setView(e,t){e.view=t},setRdvs(e,t){e.rdvs=t}},je={};var Be={namespaced:!0,state:xe,actions:je,mutations:Te},Ee=(0,Oe.MT)({state:{},getters:{},mutations:{},actions:{},modules:{core:Be}}),Le=o(2026),ze=o(5523);(0,r.ri)(d).use(Ee).use(Ve).use(Le.ZP).use(j.h).use(ze.ZP).mount("#app")},1330:function(e,t,o){"use strict";o.d(t,{h:function(){return a},kW:function(){return u}});var r=o(5288),n=o(9373),i=o(2213),l=o(114);const s={rdvs:{}},a=(0,r.wI)(s),d=(0,r.ms)(a),u=new l.GL(d),c=new n.x$("rdv",d,{awareness:u,signaling:["wss://noosld-webrtc.glitch.me"]}),p=new i.VU("wss://yjs-leveldb.glitch.me/rdv","rdv",d,{awareness:u});c.on("status",(e=>{console.log("** webrtcProvider in y_store",e.status)})),p.on("status",(e=>{console.log("## websocketProvider in y_store",e.status)}))},5469:function(e,t,o){"use strict";e.exports=o.p+"img/here.b7fe6ce7.png"},7676:function(e,t,o){"use strict";e.exports=o.p+"img/marker.f58b9982.png"},7548:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAADUElEQVR4Xu2a/ZFNQRDFz0aACBABIkAEiAARIAJEgAjYCBABIkAEiAARUD91p+rtrX13pme6+131bv+zW/VmpnvO9MeZvnOiI5eTI9+/NgA2DzhyBA4RAtclXZN0ZYb9d0lfJX3JPJMsAG5Jui/prqSLlQ0CxEdJp9PfUDyiAeCUX0sCgB4BiIeSACVEIgF4JOmlk9WPJb1yWuvMMlEAcOoPnA1+M3mD67IRALydYt3V0Gmxd5LueS7sDQAuj+tHCqFASLiIJwBkeE4/Q/ACvGFYPAH4dk5tHzZwzwJUhasei3sBQMIj8WUK5ZHEOCReAGSeftmwixd4AAC1/Ww8hvcTR4DoIOQPvOiOcZ0bo9TZAwAy8guD4Uuuaw2lJ6NkywMATvFmIwDPJT2rjOX3p43rfRqg2f9UZANwSdKvyua4LP38nwD4E2Bsq1cBJqB2i4cHtAJA4iPZtUgrAMNenAkAjQ6ydotQVaguLTK0h6HJk3WW04K91e729BDgFS2yiiQIG6Pb0yKAdbsy0HKbpGs0dO328AArD+ASAxeYVwOyP3zCsqFV8IAeJsjmAaKEA27f0i+cO88qmCBGsZHLLTHgOOaHx+3TIwTYU0YjZI6dS2PECwBL5vZygpaKUtXlBQCKiGnrba5q4J4BFlK1qMMTAHr/H3p3ZJxHKS1XaePUs8M9AWBlCynqNXyY/Owq9gYgwwvcTh8gvAGI9gLX048CILIiuGT+yBAoa0fwApe6P088ESGADng97PBCb6abzYP1Qblr3SSzuigAMMTzS5Hbl6AsDyh6PMiRG+k5zz0iPcAjFH5PFx531y9gRAMwGgphrp8JALp6qkJI1s/OAbv6aIryOqxFeC3W2hRtWW/vmIwQKMohSIBQK43EPZuvNU+HNp4dAkVfS2kMj/sMJrh0Okvf/lq+Hbqc/KE8YIkfhNb7fahl5oBdG6DK9A5KUiTpcZUOq/drA2CXJPE/CTJ98yg+lAeUAymlLvWB9KGToGsSG13s0B4wav/w/F4ASFitz2KGjWxcgJ6B+dlcLwCWdzyN9g8P6+oXbgB04r55gOEpWyfG5mmpIcAjBstDBvNuOibAJczP6HtzQId965yyAbDOc8mzavOAPKzXqekvWhOGQSnRji0AAAAASUVORK5CYII="},2480:function(){}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,r,n,i){if(!r){var l=1/0;for(u=0;u<e.length;u++){r=e[u][0],n=e[u][1],i=e[u][2];for(var s=!0,a=0;a<r.length;a++)(!1&i||l>=i)&&Object.keys(o.O).every((function(e){return o.O[e](r[a])}))?r.splice(a--,1):(s=!1,i<l&&(l=i));if(s){e.splice(u--,1);var d=n();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,n,i]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,r){return o.f[r](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/about.a8e898de.js"}}(),function(){o.miniCssF=function(e){return"css/about.9dcd382b.css"}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="rdv:";o.l=function(r,n,i,l){if(e[r])e[r].push(n);else{var s,a;if(void 0!==i)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==r||c.getAttribute("data-webpack")==t+i){s=c;break}}s||(a=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[n];var p=function(t,o){s.onerror=s.onload=null,clearTimeout(m);var n=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((function(e){return e(o)})),t)return t(o)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),a&&document.head.appendChild(s)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/rdv/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,r,n){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var l=function(o){if(i.onerror=i.onload=null,"load"===o.type)r();else{var l=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.href||t,a=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");a.code="CSS_CHUNK_LOAD_FAILED",a.type=l,a.request=s,i.parentNode&&i.parentNode.removeChild(i),n(a)}};return i.onerror=i.onload=l,i.href=t,o?o.parentNode.insertBefore(i,o.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var o=document.getElementsByTagName("link"),r=0;r<o.length;r++){var n=o[r],i=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(i===e||i===t))return n}var l=document.getElementsByTagName("style");for(r=0;r<l.length;r++){n=l[r],i=n.getAttribute("data-href");if(i===e||i===t)return n}},r=function(r){return new Promise((function(n,i){var l=o.miniCssF(r),s=o.p+l;if(t(l,s))return n();e(r,s,null,n,i)}))},n={143:0};o.f.miniCss=function(e,t){var o={443:1};n[e]?t.push(n[e]):0!==n[e]&&o[e]&&t.push(n[e]=r(e).then((function(){n[e]=0}),(function(t){throw delete n[e],t})))}}}(),function(){var e={143:0};o.f.j=function(t,r){var n=o.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise((function(o,r){n=e[t]=[o,r]}));r.push(n[2]=i);var l=o.p+o.u(t),s=new Error,a=function(r){if(o.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),l=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+l+")",s.name="ChunkLoadError",s.type=i,s.request=l,n[1](s)}};o.l(l,a,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,i,l=r[0],s=r[1],a=r[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(a)var u=a(o)}for(t&&t(r);d<l.length;d++)i=l[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},r=self["webpackChunkrdv"]=self["webpackChunkrdv"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[998],(function(){return o(444)}));r=o.O(r)})();
//# sourceMappingURL=app.fe12020d.js.map